name: v3 v4 Image Builds from template
on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  build-v3-images:
    uses: ./.github/workflows/build-template.yml
    with:
      build-context: '.'
      tbt_version: "3.00"
      version: "3.16.2"
      twcv: "v1.6.30"
      ticv: "v1.8.0"
      tag: "edgd1er/nordlynx-transmission:v3"
    secrets: inherit

  build-v4-images:
    uses: ./.github/workflows/build-template.yml
    with:
      build-context: '.'
      tbt_version: "4.0.3"
      version: "3.16.2"
      twcv: "v1.6.30"
      ticv: "v1.8.0"
      tag: "edgd1er/nordlynx-transmission:v4,edgd1er/nordlynx-transmission:latest"
    secrets: inherit

  build-v4dev-images:
    uses: ./.github/workflows/build-template.yml
    with:
      build-context: '.'
      tbt_version: "dev"
      version: "3.16.2"
      twcv: "v1.6.30"
      ticv: "v1.8.0"
      tag: "edgd1er/nordlynx-transmission:dev"
      ptf: "linux/amd64,linux/arm64,linux/arm/v7"
    secrets: inherit